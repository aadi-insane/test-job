<h1 class="mb-4">All Users</h1>

<div class="mb-4">
  <%= form_with url: admin_users_path, method: :get, local: true, class: "form-inline row g-2 align-items-center" do %>
    <!-- Search Input -->
    <div class="col-auto">
      <label for="query" class="form-label fw-bold mb-0 me-2">Search:</label>
    </div>
    <div class="col-auto">
      <%= text_field_tag :query, params[:query], placeholder: "Name, email, or role", class: "form-control" %>
    </div>

    <!-- Role Filter -->
    <div class="col-auto">
      <label for="role" class="form-label fw-bold mb-0 me-2">Filter by Role:</label>
    </div>
    <div class="col-auto">
      <%= select_tag :role, 
          options_for_select(
            [["All Roles", ""], ["Manager", "manager"], ["Contributor", "contributor"]],
            params[:role]
          ), 
          class: "form-select" %>
    </div>

    <!-- Buttons -->
    <div class="col-auto">
      <%= submit_tag "Filter", class: "btn btn-primary" %>
      <%= link_to "Reset", admin_users_path, class: "btn btn-secondary" %>
    </div>
  <% end %>
</div>

<table class="table table-hover table-bordered">
  <thead class="table-primary">
    <tr>
      <th scope="col" class="text-center">ID</th>
      <th scope="col" class="text-center">Name</th>
      <th class="text-center">Email</th>
      <th class="text-center">Role</th>
      <th colspan="2" class="text-center">Action</th>
    </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>
      <% row_class = user.role == 'manager' ? 'bg-warning' : 'bg-info' %>
      <tr class="<%= row_class %>">
        <th scope="row" class="text-center"><%= user.id %></th>
        <td class="text-center"><%= user.name || "N/A" %></td>
        <td class="text-center"><%= user.email %></td>
        <td class="text-center"><%= user.role.humanize %></td>
        <td class="text-center"><%= link_to "Show", admin_user_path(user), class: "btn btn-success" %></td>
        <td class="text-center"><%= link_to "Edit Role", edit_admin_user_path(user), class: "btn btn-success" %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="d-flex justify-content-center">
  <%= paginate @users, theme: 'bootstrap4' %>
</div>
