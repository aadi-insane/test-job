<div class="card shadow-lg border-0 w-50 mx-auto my-5" style="border-radius: 20px; overflow: hidden; min-height: 450px;">
  <div class="bg-primary text-white text-center py-4">
    <img src="https://cdn-icons-png.flaticon.com/512/219/219988.png" alt="User Avatar"
         class="rounded-circle border border-3 border-white"
         style="width: 100px; height: 100px; object-fit: cover;">
    <h4 class="mt-3 mb-0"><%= @user.name.present? ? @user.name : 'No name provided' %></h4>
    <small class="text-light"><%= @user.role.humanize %></small>
  </div>

  <div class="card-body text-center">
    <p class="mb-2">
      <strong>Email:</strong> <%= @user.email %>
    </p>

    <% if @user.manager? %>
      <hr>
      <div class="text-start px-3">
        <p class="fw-bold mb-1 text-primary">Projects:</p>
        <% if @user.projects_as_manager.present? %>
          <% visible_projects = @user.projects_as_manager.first(5) %>
          <ul class="list-group list-group-flush">
            <% visible_projects.each_with_index do |p, i| %>
              <li class="list-group-item border-0 ps-0">
                <strong><%= i + 1 %>.</strong> <%= p.title %>
              </li>
            <% end %>
            <% if @user.projects_as_manager.count > 5 %>
              <li class="list-group-item border-0 ps-0 text-muted">
                ... and <%= @user.projects_as_manager.count - 5 %> more
              </li>
            <% end %>
          </ul>
        <% else %>
          <p class="text-muted mb-0">No Projects Yet!</p>
        <% end %>
      </div>
    <% else %>
      <hr>
      <div class="text-start px-3">
        <p class="fw-bold mb-1 text-primary">Tasks:</p>
        <% if @user.tasks_as_contributor.present? %>
          <% visible_tasks = @user.tasks_as_contributor.first(5) %>
          <ul class="list-group list-group-flush">
            <% visible_tasks.each_with_index do |t, i| %>
              <li class="list-group-item border-0 ps-0">
                <strong><%= i + 1 %>.</strong> <%= t.title %>
                <small class="text-muted">from <strong><%= t.project.title %></strong></small>
              </li>
            <% end %>
            <% if @user.tasks_as_contributor.count > 5 %>
              <li class="list-group-item border-0 ps-0 text-muted">
                ... and <%= @user.tasks_as_contributor.count - 5 %> more
              </li>
            <% end %>
          </ul>
        <% else %>
          <p class="text-muted mb-0">No Tasks Yet!</p>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<div class="text-center">
    <%= link_to "Back", admin_users_path, class: "btn btn-secondary w-25" %>
</div>
